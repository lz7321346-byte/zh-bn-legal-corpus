# 启动后端服务 - 简单步骤

## 问题
后端服务未运行，导致 http://127.0.0.1:8000 拒绝连接。

## 解决方案

### 方法 1：使用 PowerShell 脚本（推荐）

1. **打开 PowerShell**（以管理员身份运行，如果需要）

2. **进入项目目录**：
   ```powershell
   cd "C:\Users\周科伽、\Desktop\zh-bn-legal-corpus-main"
   ```

3. **运行启动脚本**：
   ```powershell
   .\start-backend.ps1
   ```

### 方法 2：手动启动（如果脚本不工作）

**在 PowerShell 中按顺序执行以下命令：**

```powershell
# 1. 进入项目目录
cd "C:\Users\周科伽、\Desktop\zh-bn-legal-corpus-main"

# 2. 激活虚拟环境
& .\.venv\Scripts\Activate.ps1

# 3. 启动服务
uvicorn backend.app.main:app --host 127.0.0.1 --port 8000 --reload
```

### 方法 3：如果虚拟环境不在项目目录

如果虚拟环境在用户主目录（`C:\Users\周科伽、\.venv`），请执行：

```powershell
# 1. 进入项目目录
cd "C:\Users\周科伽、\Desktop\zh-bn-legal-corpus-main"

# 2. 删除错误的虚拟环境（如果存在）
Remove-Item -Recurse -Force "C:\Users\周科伽、\.venv" -ErrorAction SilentlyContinue

# 3. 在项目目录创建虚拟环境
python -m venv .venv

# 4. 激活虚拟环境
& .\.venv\Scripts\Activate.ps1

# 5. 安装依赖
pip install -e .[dev]

# 6. 启动服务
uvicorn backend.app.main:app --host 127.0.0.1 --port 8000 --reload
```

## 验证服务是否启动成功

启动成功后，您应该看到类似以下输出：

```
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [xxxxx] using WatchFiles
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

然后您可以：

1. **访问 API 文档**：http://127.0.0.1:8000/docs
2. **测试搜索 API**：http://127.0.0.1:8000/api/v1/terms?q=宪法
3. **访问前端**：http://localhost:3000/terms（需要先启动前端服务）

## 常见问题

### 问题 1：`uvicorn` 命令未找到

**原因**：依赖未安装或虚拟环境未激活

**解决**：
```powershell
# 确保虚拟环境已激活（命令提示符前应该有 (.venv)）
# 然后安装依赖
pip install -e .[dev]
```

### 问题 2：端口 8000 已被占用

**原因**：另一个服务正在使用端口 8000

**解决**：
- 关闭占用端口的程序，或
- 使用其他端口：`uvicorn backend.app.main:app --host 127.0.0.1 --port 8001 --reload`
- 同时需要更新 `frontend/next.config.js` 中的代理端口

### 问题 3：执行策略错误

**错误信息**：`无法加载文件...因为在此系统上禁止运行脚本`

**解决**：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

## 停止服务

在运行服务的 PowerShell 窗口中按 `Ctrl+C`

