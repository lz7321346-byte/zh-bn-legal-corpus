# 启动后端服务 - 详细步骤

## 问题解决

如果您在创建虚拟环境时遇到问题，请按照以下步骤操作：

## 步骤 1：进入项目目录

在 PowerShell 中执行：

```powershell
# 方法 1：使用 cd 命令（推荐）
cd "C:\Users\周科伽、\Desktop\zh-bn-legal-corpus-main"

# 方法 2：如果已经在 Desktop，使用相对路径
cd Desktop\zh-bn-legal-corpus-main
```

**验证是否在正确目录：**
```powershell
# 应该能看到 pyproject.toml 文件
ls pyproject.toml
```

## 步骤 2：创建虚拟环境

```powershell
python -m venv .venv
```

如果遇到权限问题或中断，可以尝试：
```powershell
# 使用 --without-pip 选项（然后手动安装 pip）
python -m venv .venv --without-pip
.venv\Scripts\python.exe -m ensurepip --upgrade
```

## 步骤 3：激活虚拟环境

```powershell
# PowerShell
.venv\Scripts\Activate.ps1

# 如果 PowerShell 执行策略限制，先执行：
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 或者使用 CMD 方式：
.venv\Scripts\activate.bat
```

## 步骤 4：安装依赖

```powershell
pip install -e .[dev]
```

## 步骤 5：启动服务

```powershell
uvicorn backend.app.main:app --host 127.0.0.1 --port 8000 --reload
```

## 快速启动（使用脚本）

我已经创建了一个启动脚本 `start-backend.ps1`，您可以直接使用：

```powershell
# 确保在项目根目录
cd "C:\Users\周科伽、\Desktop\zh-bn-legal-corpus-main"

# 执行脚本
.\start-backend.ps1
```

## 如果仍然遇到问题

### 问题 1：路径中的中文字符导致问题

**解决方案：**
- 使用引号包裹路径：`cd "C:\Users\周科伽、\Desktop\zh-bn-legal-corpus-main"`
- 或者使用短路径名（8.3 格式）

### 问题 2：PowerShell 执行策略限制

**解决方案：**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 问题 3：虚拟环境创建被中断

**解决方案：**
- 删除已创建的 `.venv` 文件夹（如果存在）
- 重新执行创建命令
- 确保有足够的磁盘空间和权限

### 问题 4：pip 安装失败

**解决方案：**
```powershell
# 升级 pip
python -m pip install --upgrade pip

# 然后重新安装依赖
pip install -e .[dev]
```

## 验证服务运行

启动成功后，您应该看到：
```
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

然后可以：
- 访问 http://127.0.0.1:8000 查看服务信息
- 访问 http://127.0.0.1:8000/docs 查看 API 文档
- 访问 http://127.0.0.1:8000/api/v1/terms?q=宪法 测试搜索

